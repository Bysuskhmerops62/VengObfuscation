<!DOCTYPE html>
<html>
<head>
  <title>Check Script</title>
  <style>
    body { background:#111; color:#fff; font-family:monospace; padding:40px; }
    input, button { width:100%; padding:10px; margin-top:10px; border:none; border-radius:5px; }
    button { background:orange; color:#000; font-weight:bold; }
    pre { background:#222; padding:10px; margin-top:20px; border-radius:5px; }
  </style>
</head>
<body>
  <h2>üîê Script Viewer</h2>
  <input id="password" placeholder="Enter password..." />
  <button onclick="check()">Unlock</button>
  <div id="result"></div>
  <pre id="debug"></pre>

  <script>
    function getUIDFromURL() {
      const params = new URLSearchParams(window.location.search);
      return params.get('uid') || '';
    }

    const uid = getUIDFromURL();
    const dbUrl = `https://ta-bin-2-default-rtdb.firebaseio.com/data/${uid}.json`;

    async function check() {
      const pwInput = document.getElementById("password").value.trim();
      const result = document.getElementById("result");
      const debug = document.getElementById("debug");

      if (!uid) {
        result.innerHTML = "‚ùå UID not found in URL!";
        return;
      }

      try {
        const res = await fetch(dbUrl);
        const data = await res.json();

        debug.textContent = JSON.stringify(data, null, 2);

        if (!data) {
          result.innerHTML = "‚ùå Script not found.";
          return;
        }

        const inputPw = pwInput.toLowerCase();
        const realPw = data.password.trim().toLowerCase();

        if (inputPw === realPw) {
          result.innerHTML = `<pre>${data.script}</pre>`;
        } else {
          result.innerHTML = "‚ùå Incorrect password.";
        }

      } catch (e) {
        result.innerHTML = "‚ö†Ô∏è Error fetching script.";
        debug.textContent = e.message;
      }
    }
  </script>
</body>
</html>
